#!/bin/bash

# === SET TIMEZONE MANUAL ===
export TZ="Asia/Jakarta"

# === CONFIG TELEGRAM ===
BOT_TOKEN="8592209633:AAEANR9TVRVkoIN1pH4-Ym89OHYWFnBR5IY"
CHAT_ID="7964289925"

# === DIRECTORY TARGET ===
TARGET_DIR="/home/n1563787/public_html/"

# === CEK FILE YANG DIUBAH 5 MENIT TERAKHIR ===
FILES=$(find "$TARGET_DIR" -type f \
  -mmin -5 \
  -not -path "*/cache/*" \
  | head -n 50)

# === JIKA TIDAK ADA PERUBAHAN, DIAM (NORMAL) ===
[ -z "$FILES" ] && exit 0

# === KIRIM KE TELEGRAM ===
for file in $FILES; do
  curl -s -X POST "https://api.telegram.org/bot$BOT_TOKEN/sendMessage" \
    -d chat_id="$CHAT_ID" \
    -d text="ðŸ“„ File diubah: $file" >/dev/null
done
